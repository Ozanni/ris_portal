import{r as f,a as t,F,j as I,S as W,aF as v,aG as p,ag as B,C as Q,bd as Y}from"./vendor-1c7a9a47.js";import{bj as u,bo as H,ca as M,cb as z,fe as A,f7 as P,b9 as O,bD as _,ff as h,bc as E,cd as $,ex as T,ed as S,c8 as R,dn as j,e_ as D,cj as q,eZ as K,dM as G,cR as X,bm as Z,c2 as J,f6 as k,f9 as ee,fa as oe,cH as te,fb as se}from"./index-cdd5c634.js";import{C as re}from"./CollapsiblePanel-1b32f69e.js";import{u as ae,a as w,b as ie,c as ne,d as le}from"./modalityRoom-2c3daa2a.js";import{c as ce}from"./checkUpdateFields-04f48d15.js";const de=s=>{const{modalityRoomID:i}=s,e=u(),{data:o,isFetching:a,refetch:r}=H({filter:{roomID:i}}),n=f.useMemo(()=>[{type:"record",name:"id",headerLabel:"ID",renderCell:c=>t(M,{children:c.getValue()}),columnDefOptions:{maxSize:50}},{type:"record",name:"name",headerLabel:e.resources.modality.name.short()},{type:"record",name:"modalityType",headerLabel:e.resources.modality.modalityType.short()},{type:"record",name:"code",headerLabel:e.resources.modality.code.short()},{type:"record",name:"enabled",headerLabel:e.messages.status.long(),renderCell:c=>t(M,{children:c.getValue()?e.resources.modality.enabled():e.resources.modality.disabled()})}],[e.messages,e.resources.modality]);return t(z,{tableId:A,data:o==null?void 0:o.list,tableColumnsDescription:n,paginationControls:{totalRecords:o==null?void 0:o.meta.totalRecords,pageSize:o==null?void 0:o.list.length},MyDataGridProps:{isLoading:a},TanstackTableOptions:{enableRowSelection:!1},renderActionButtons:()=>t(P,{tableId:A,refetch:r,hideButtonAdd:!0,hideButtonDelete:!0,hideButtonEdit:!0})})},me=()=>{const s=O(_(h)),i=s==null?void 0:s.id,e=s==null?void 0:s.name,{isOpen:o,open:a,close:r}=E(!0),n=u();return i?t(re,{initialExpanded:o,onExpand:a,onCollapse:r,onClose:r,title:n.messages.titles.modalityList({resource:e||""}),children:t(de,{modalityRoomID:i})},i):t(F,{})},N=s=>{const{record:i,control:e,onKeyDown:o}=s,a=u();return t(F,{children:I(W,{spacing:1,alignItems:"start",width:"500px",children:[i&&t($,{value:i.id,label:"ID",size:"small",disabled:!0,fullWidth:!0}),t(T,{name:"code",control:e,MyTextFieldProps:{label:a.resources.modalityRoom.code(),placeholder:a.resources.modalityRoom.code(),fullWidth:!0,required:!0,size:"small",onKeyDown:o}}),t(T,{name:"name",control:e,MyTextFieldProps:{label:a.resources.modalityRoom.name(),placeholder:a.resources.modalityRoom.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:o}}),t(T,{name:"description",control:e,MyTextFieldProps:{label:a.resources.modalityRoom.description(),placeholder:a.resources.modalityRoom.description(),fullWidth:!0,onKeyDown:o,multiline:!0,rows:2}})]})})},ue=s=>{const{onSuccessCallback:i}=s,[e]=ae(),{data:o}=w({filter:{}}),a=o==null?void 0:o.list,r=u(),n=S(),c={mode:"onChange",criteriaMode:"all",resolver:v(p.object({name:p.string().trim().min(1,r.messages.validation.genericRequired({resource:r.resources.modalityRoom.name()})),code:p.string().trim().min(1,r.messages.validation.genericRequired({resource:r.resources.modalityRoom.code()})).refine(m=>!(a&&a.some(l=>l.code===m)),{message:r.messages.validation.genericDuplicated({name:r.resources.modalityRoom.code()})}),parentID:p.number().optional(),description:p.string().optional()})),defaultValues:{name:"",code:"",description:""}},d=R("success",r.messages.titles.createResource({resource:r.resources.modalityRoom.title().toLowerCase()})),y=R("error",r.messages.titles.createResource({resource:r.resources.modalityRoom.title().toLowerCase()}));return t(j,{registerFormFunctions:m=>n("submitCreateForm",()=>m.submit&&m.submit()),onSubmit:async m=>{const{code:l,description:b,name:C}=m;try{l&&C&&("error"in await e({code:l,description:b,name:C})?y():(d(),i()))}catch{y()}},submitOnEnter:!0,formOptions:c,renderInputs:m=>t(N,{...m})})},ye=()=>{const{isOpen:s,open:i,close:e}=E(!1);return S()("openCreateModal",i),t(B,{open:s,children:t(U,{closeModal:e})})},U=f.forwardRef(s=>{const{closeModal:i}=s,e=u(),o=D();return t(q,{confirmLabel:e.buttons.create(),handleClose:i,BodyComponent:t(ue,{onSuccessCallback:i}),handleConfirm:()=>o.submitCreateForm(),title:e.messages.titles.createResource({resource:e.resources.modalityRoom.title().toLowerCase()})})});U.displayName="ModalRoomCreateModal";const pe=s=>{const{onSuccessCallback:i,record:e}=s,[o]=ie(),{data:a}=w({filter:{}}),r=a==null?void 0:a.list.filter(l=>l.id!==e.id),n=u(),c=S(),d={mode:"onChange",criteriaMode:"all",resolver:v(p.object({name:p.string().trim().min(1,n.messages.validation.genericRequired({resource:n.resources.modalityRoom.name()})),code:p.string().trim().min(1,n.messages.validation.genericRequired({resource:n.resources.modalityRoom.code()})).refine(l=>!(r&&r.some(b=>b.code===l)),{message:n.messages.validation.genericDuplicated({name:n.resources.modalityRoom.code()})}),description:p.string().optional().transform(K)})),defaultValues:{name:e.name??"",code:e.code??"",description:e.description??""}},y=R("success",n.messages.titles.editResource({resource:n.resources.modalityRoom.title().toLowerCase()})),g=R("error",n.messages.titles.editResource({resource:n.resources.modalityRoom.title().toLowerCase()}));return t(j,{registerFormFunctions:l=>c("submitEditForm",()=>l.submit&&l.submit()),onSubmit:async l=>{const{updateData:b,canUpdate:C}=ce(Object.keys(l),e,l),L={name:b.name??void 0,description:b.description??void 0,code:b.code??void 0,id:e.id};if(C)try{"error"in await o(L)?g():(y(),i())}catch{g()}},submitOnEnter:!0,formOptions:d,renderInputs:l=>t(N,{record:e,...l})})},be=()=>{const{isOpen:s,open:i,close:e}=E(!1),o=O(_(X.MODALITY_ROOM)),a=S();a("openEditModal",i);const r=u(),n=G(),[c]=le(),d=R("success",r.messages.titles.deleteResource({resource:r.resources.modalityRoom.title().toLowerCase()})),y=R("error",r.messages.titles.deleteResource({resource:r.resources.modalityRoom.title().toLowerCase()})),g=f.useCallback(()=>{n({message:`${r.messages.notification.delete({name:`${o==null?void 0:o.name}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in c({id:o==null?void 0:o.id})?y():(d(),e())}}})},[e,c,y,n,d,o==null?void 0:o.id,o==null?void 0:o.name,r.messages.notification]);return a("submitDelete",()=>g()),o?t(B,{open:s,children:t(V,{record:o,closeModal:e})}):t(F,{})},V=f.forwardRef((s,i)=>{const{closeModal:e,record:o}=s,a=u();G();const r=D(),{data:n}=ne({id:o.id});return t(q,{ref:i,confirmLabel:a.buttons.update(),handleConfirm:()=>r.submitEditForm(),handleClose:e,BodyComponent:n?t(pe,{record:n,onSuccessCallback:e}):t(M,{children:t(Q,{})}),title:a.messages.titles.editResource({resource:a.resources.modalityRoom.title().toLowerCase()})})});V.displayName="ModalityRoomEditModal";const Re=()=>{const s=u(),i=O(Z(h)),{data:e,isFetching:o,refetch:a}=w(i||Y.skipToken),r=D(),{open:n}=J(),c=f.useMemo(()=>[{type:"custom",getColumnDef:d=>d.display({id:"stt",header:s.messages.stt(),cell:y=>t(M,{children:y.row.index+1}),minSize:k,maxSize:k})},{type:"record",name:"id",headerLabel:"ID",renderCell:d=>t(M,{children:d.getValue()}),columnDefOptions:{maxSize:150},enableSort:!0},{type:"record",name:"code",headerLabel:s.resources.modalityRoom.code(),columnDefOptions:{size:550}},{type:"record",name:"name",headerLabel:s.resources.modalityRoom.name(),columnDefOptions:{size:950}}],[s.messages,s.resources.modalityRoom]);return t(z,{tableId:h,data:e==null?void 0:e.list,tableColumnsDescription:c,MyDataGridProps:{isLoading:o,onRowRightClick:d=>{n(d)},onRowDoubleClick(){r.openEditModal()}},paginationControls:{totalRecords:e==null?void 0:e.meta.totalRecords,pageSize:e==null?void 0:e.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>t(P,{tableId:h,refetch:a})})},Fe=()=>{const s=u(),i=D();return I(ee,{children:[t(oe,{title:s.resources.modalityRoom.title(),TableComponent:t(Re,{}),PanelComponent:t(me,{}),ActionButtons:t(F,{children:t(te,{variant:"contained",onClick:()=>i.openCreateModal(),children:s.buttons.create()})})}),t(ye,{}),t(be,{}),t(se,{})]})};export{Fe as AdminModalityRoom};
