import{a as i,ao as G,j as L,S as B,Z as _,T as Q,aF as R,aG as d,r as b,ag as F,C as $,F as P,bd as W}from"./vendor-1c7a9a47.js";import{cP as S,cR as u,eN as H,cQ as O,cS as E,bj as y,e5 as U,dm as V,cd as Y,ex as A,ew as K,e2 as J,ed as f,c8 as g,dn as q,e_ as C,cj as w,bc as N,dM as x,ca as I,b9 as v,bD as X,bm as Z,ge as T,c2 as ee,f6 as M,cb as te,f7 as se,f9 as re,fa as ie,fb as oe}from"./index-cdd5c634.js";import{i as k}from"./validateJSON-0b706ffc.js";const ne=S.injectEndpoints({endpoints:t=>({getOneApplication:t.query({query:({id:s})=>({url:`${u.APPLICATION}/${s}`,method:"GET",useAsync:!0,useHospitalID:!0}),providesTags:(s,e)=>e?[]:[{type:u.APPLICATION,id:s==null?void 0:s.id}],transformResponse:H}),getListApplications:t.query({query:s=>O(s,u.APPLICATION),providesTags:(s={list:[],meta:{totalRecords:0}})=>[{type:u.APPLICATION,id:"LIST"},...s.list.map(e=>({type:u.APPLICATION,id:e.id}))],transformResponse:E}),createApplication:t.mutation({query:s=>({url:u.APPLICATION,method:"POST",data:s,useAsync:!0,useHospitalID:!0}),invalidatesTags:(s,e)=>e?[]:[{type:u.APPLICATION,id:"LIST"}]}),updateApplication:t.mutation({query:s=>({url:u.APPLICATION,method:"PUT",data:s,useAsync:!0,useHospitalID:!0}),invalidatesTags:(s,e,r)=>e?[]:[{type:u.APPLICATION,id:r.id}]}),deleteApplication:t.mutation({query:s=>({url:`/${u.APPLICATION}/${s==null?void 0:s.id}`,method:"DELETE",data:s,useAsync:!0,useHospitalID:!0}),invalidatesTags:(s,e,r)=>e?[]:[{type:u.APPLICATION,id:r.id}]})})}),{useGetListApplicationsQuery:ae,useLazyGetListApplicationsQuery:Ie,useGetOneApplicationQuery:ce,useCreateApplicationMutation:le,useUpdateApplicationMutation:pe,useDeleteApplicationMutation:ue}=ne,de=S.injectEndpoints({endpoints:t=>({getListApplicationTypes:t.query({query:s=>O(s,u.APPLICATION_TYPE),providesTags:(s={list:[],meta:{totalRecords:0}})=>[{type:u.APPLICATION_TYPE,id:"LIST"},...s.list.map(e=>({type:u.APPLICATION_TYPE,id:e.id}))],transformResponse:E})})}),{useGetListApplicationTypesQuery:Pe,useLazyGetListApplicationTypesQuery:me}=de,ye=({control:t,watch:s,disabled:e=!1,required:r=!1})=>{const c=y(),n=s("type"),[p]=me(),m=async()=>{var l;return((l=(await p({filter:{}})).data)==null?void 0:l.list)??[]};return i(U,{name:"type",control:t,required:r,MySelectProps:{label:c.resources.application.type(),disabled:e},disableValue:n,onGetListRecord:m,renderSelectField:({listData:l,formSelectFieldProps:a})=>i(V,{...a,children:l.map(o=>i(G,{value:(o==null?void 0:o.id)||"",children:o.id},o.id))})})},D=t=>{const{record:s,control:e,onKeyDown:r,watch:c}=t,n=y();return L(B,{spacing:1,alignItems:"start",width:"500px",children:[s&&i(Y,{value:s.id,size:"small",label:"ID",disabled:!0,fullWidth:!0}),i(ye,{control:e,watch:c,required:!0}),i(A,{name:"name",control:e,MyTextFieldProps:{label:n.resources.application.name(),placeholder:n.resources.application.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:r}}),i(A,{name:"url",control:e,MyTextFieldProps:{label:n.resources.application.url(),placeholder:n.resources.application.url(),fullWidth:!0,required:!0,size:"small",onKeyDown:r}}),i(A,{name:"secret",control:e,MyTextFieldProps:{label:n.resources.application.secret(),placeholder:n.resources.application.secret(),fullWidth:!0,size:"small",onKeyDown:r}}),i(A,{name:"config",control:e,MyTextFieldProps:{label:n.resources.application.config(),placeholder:n.resources.application.config(),fullWidth:!0,size:"small",onKeyDown:r,multiline:!0,minRows:3}}),i(K,{control:e,render:({value:p,onChange:m})=>L(_,{sx:{display:"flex",alignItems:"center"},children:[i(J,{checked:!!p,onChange:m}),i(Q,{children:n.resources.application.preferred()})]}),name:"enabled"})]})},ge=t=>{const{onSuccessCallback:s}=t,e=y(),[r]=le(),c=f(),n=g("success",e.messages.titles.createResource({resource:e.resources.application.title.short().toLowerCase()})),p=g("error",e.messages.titles.createResource({resource:e.resources.application.title.short().toLowerCase()})),m=async a=>{try{const o={config:a.config??"",name:a.name??"",enabled:a.enabled??!1,secret:a.secret??"",type:a.type??"",url:a.url??""};"error"in await r(o)?p():(n(),s())}catch{p()}},l={mode:"onBlur",criteriaMode:"all",resolver:R(d.object({type:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.application.type()})),name:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.application.name()})),url:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.application.url()})),secret:d.string().optional(),config:d.string().refine(a=>a.length?k(a):!0,e.messages.validation.genericRequiredType({resource:e.resources.application.config(),type:"jsonObject"})).optional(),preferred:d.boolean().optional()})),defaultValues:{config:"",name:"",enabled:!1,secret:"",type:"",url:""}};return i(q,{registerFormFunctions:a=>c("submitCreateForm",()=>a.submit&&a.submit()),onSubmit:m,submitOnEnter:!0,formOptions:l,renderInputs:a=>i(D,{onSuccessCallback:s,...a})})},Ae=()=>{const{isOpen:t,open:s,close:e}=N(!1);return f()("openCreateModal",s),i(F,{open:t,children:i(z,{closeModal:e})})},z=b.forwardRef((t,s)=>{const{closeModal:e}=t,r=y(),c=C();return i(w,{ref:s,confirmLabel:r.buttons.create(),handleClose:e,BodyComponent:i(ge,{onSuccessCallback:e}),handleConfirm:()=>c.submitCreateForm(),title:r.messages.titles.createResource({resource:r.resources.application.title.short().toLowerCase()})})});z.displayName="ApplicationCreateModal";const be=t=>{const{onSuccessCallback:s,record:e}=t,r=y(),[c]=pe(),n=f(),p=g("success",r.messages.titles.editResource({resource:r.resources.application.title.short().toLowerCase()})),m=g("error",r.messages.titles.editResource({resource:r.resources.application.title.short().toLowerCase()})),l=async o=>{try{"error"in await c({config:o.config??"",id:e.id,name:o.name??"",enabled:o.enabled??!1,secret:o.secret??"",type:o.type??"",url:o.url??""})?m():(p(),s())}catch{m()}},a={mode:"onBlur",criteriaMode:"all",resolver:R(d.object({type:d.string().trim().min(1,r.messages.validation.genericRequired({resource:r.resources.application.type()})),name:d.string().trim().min(1,r.messages.validation.genericRequired({resource:r.resources.application.name()})),url:d.string().trim().min(1,r.messages.validation.genericRequired({resource:r.resources.application.url()})),secret:d.string().optional(),config:d.string().refine(o=>o.length?k(o):!0,r.messages.validation.genericRequiredType({resource:r.resources.application.config(),type:"jsonObject"})).optional(),preferred:d.boolean().optional()})),defaultValues:{config:e.config??"",name:e.name??"",enabled:e.enabled,secret:e.secret,type:e.type??"",url:e.url??""}};return i(q,{registerFormFunctions:o=>n("submitEditForm",()=>o.submit&&o.submit()),onSubmit:l,submitOnEnter:!0,formOptions:a,renderInputs:o=>i(D,{record:e,onSuccessCallback:s,...o})})},fe=()=>{const t=v(X(u.APPLICATION)),{isOpen:s,open:e,close:r}=N(!1),c=y(),[n]=ue(),p=f(),m=x();p("openEditModal",e);const l=g("success",c.messages.titles.deleteResource({resource:c.resources.application.title.short().toLowerCase()})),a=g("error",c.messages.titles.deleteResource({resource:c.resources.application.title.short().toLowerCase()})),o=b.useCallback(()=>{m({message:`${c.messages.notification.delete({name:`${t==null?void 0:t.name}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in n({id:t==null?void 0:t.id})?a():(l(),r())}}})},[r,n,a,m,l,t==null?void 0:t.id,t==null?void 0:t.name,c.messages.notification]);return p("submitDelete",()=>o()),t?i(F,{open:s,children:i(j,{record:t,closeModal:r})}):i(P,{})},j=b.forwardRef((t,s)=>{const{closeModal:e,record:r}=t,{data:c}=ce({id:(r==null?void 0:r.id)??0},{skip:!r});x();const n=y(),p=C();return i(w,{ref:s,confirmLabel:n.buttons.update(),handleClose:e,BodyComponent:c?i(be,{onSuccessCallback:e,record:c}):i(I,{children:i($,{})}),handleConfirm:()=>p.submitEditForm(),deleteLabel:n.buttons.delete(),title:n.messages.titles.editResource({resource:n.resources.application.title.short().toLowerCase()})})});j.displayName="ApplicationEditModal";const Ce=()=>{const t=y(),s=v(Z(T)),{data:e,isFetching:r,refetch:c}=ae(s||W.skipToken),n=C(),{open:p}=ee(),m=b.useMemo(()=>[{type:"custom",getColumnDef:l=>l.display({id:"stt",header:t.messages.stt(),cell:a=>i(I,{children:a.row.index+1}),minSize:M,maxSize:M})},{type:"record",name:"type",headerLabel:t.resources.application.type(),columnDefOptions:{size:150}},{type:"record",name:"name",headerLabel:t.resources.application.name(),columnDefOptions:{size:150}},{type:"record",name:"url",headerLabel:t.resources.application.url(),columnDefOptions:{size:350}},{type:"record",name:"secret",headerLabel:t.resources.application.secret(),columnDefOptions:{size:200}},{type:"custom",getColumnDef:l=>l.display({id:"preferred",header:()=>t.resources.application.preferred(),cell:a=>{var o;return i(I,{children:(o=a.row.original)!=null&&o.enabled?t.resources.application.preferred():"KhÃ´ng"})},size:100})}],[t.messages,t.resources.application]);return i(P,{children:i(te,{tableId:T,data:e==null?void 0:e.list,tableColumnsDescription:m,MyDataGridProps:{isLoading:r,onRowRightClick:l=>{p(l)},onRowDoubleClick(){n.openEditModal()}},paginationControls:{totalRecords:e==null?void 0:e.meta.totalRecords,pageSize:e==null?void 0:e.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>i(se,{tableId:T,refetch:c})})})},Me=()=>{const t=y();return C(),L(re,{children:[i(ie,{title:t.resources.application.title.long(),ActionButtons:i(P,{}),TableComponent:i(Ce,{})}),i(oe,{}),i(Ae,{}),i(fe,{})]})};export{Me as AdminApplication};
