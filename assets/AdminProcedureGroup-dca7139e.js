import{a as t,j as y,x as j,aF as S,aG as p,S as F,ag as T,r as M,F as U,bd as W}from"./vendor-1c7a9a47.js";import{cP as $,cR as m,eN as B,cQ as H,cS as N,fg as L,bj as b,e8 as Q,e9 as V,ed as P,c8 as R,dn as A,ex as g,bc as w,e_ as h,cj as x,cd as X,dM as J,b9 as I,bD as Y,bm as Z,fz as E,c2 as K,ca as O,f6 as D,be as ee,cb as re,f7 as se,f9 as te,fa as oe,cH as ne,fb as ae}from"./index-cdd5c634.js";const ie=$.injectEndpoints({endpoints:n=>({getOneProcedureGroup:n.query({query:({id:r})=>({url:`${m.PROCEDURE_GROUP}/${r}`,method:"GET",useAsync:!0,useHospitalID:!0}),providesTags:(r,e)=>e?[]:[{type:m.PROCEDURE_GROUP,id:r==null?void 0:r.id}],transformResponse:B}),getListProcedureGroup:n.query({query:r=>H(r,"procedureGroup"),providesTags:(r={list:[],meta:{totalRecords:0}})=>[{type:m.PROCEDURE_GROUP,id:"LIST"},...r.list.map(e=>({type:m.PROCEDURE_GROUP,id:e.id}))],transformResponse:N}),createProcedureGroup:n.mutation({query:r=>({url:m.PROCEDURE_GROUP,method:"POST",data:r,useAsync:!0,useHospitalID:!0}),invalidatesTags:(r,e)=>e?[]:[{type:m.PROCEDURE_GROUP,id:"LIST"}]}),updateProcedureGroup:n.mutation({query:r=>({url:m.PROCEDURE_GROUP,method:"PUT",data:r,useAsync:!0,useHospitalID:!0}),invalidatesTags:(r,e,o)=>e?[]:[{type:m.PROCEDURE_GROUP,id:o.id}]}),deleteProcedureGroup:n.mutation({query:r=>({url:`${m.PROCEDURE_GROUP}/${r==null?void 0:r.id}`,method:"DELETE",data:r,useAsync:!0,useHospitalID:!0}),invalidatesTags:(r,e,o)=>e?[]:[{type:m.PROCEDURE_GROUP,id:o.id}]})})}),{useGetListProcedureGroupQuery:ce,useGetOneProcedureGroupQuery:ue,useCreateProcedureGroupMutation:de,useDeleteProcedureGroupMutation:le,useUpdateProcedureGroupMutation:pe}=ie,k=n=>{const{control:r,name:e}=n,{data:o}=L({filter:{}}),s=b();return t(Q,{name:e,control:r,label:s.resources.modality.procedures(),placeholder:s.resources.modality.addProcedure(),MyAutoCompleteProps:{options:(o==null?void 0:o.list)??[],isOptionEqualToValue:(a,i)=>a.id===i.id,getOptionLabel:a=>`${a==null?void 0:a.id} - ${a==null?void 0:a.name}`,fullWidth:!0,renderOption:(a,i,{selected:d})=>t("li",{...a,children:y(V,{children:[t(j,{size:"small",checked:d}),i==null?void 0:i.id,"-",i==null?void 0:i.name]})})}})},me=n=>{const{onSuccessCallback:r}=n,[e]=de(),o=b(),s=P(),a={mode:"onChange",criteriaMode:"all",resolver:S(p.object({name:p.string().trim().min(1,o.messages.validation.genericRequired({resource:o.resources.procedureGroup.name()})),description:p.string().optional(),procedureIDs:p.array(p.object({id:p.number()})).transform(c=>c==null?void 0:c.map(C=>C.id)).optional()})),defaultValues:{name:"",description:"",procedureIDs:[]}},i=R("success",o.messages.titles.createResource({resource:o.resources.procedureGroup.title().toLowerCase()})),d=R("error",o.messages.titles.createResource({resource:o.resources.procedureGroup.title().toLowerCase()}));return t(A,{registerFormFunctions:c=>s("submitCreateForm",()=>c.submit&&c.submit()),onSubmit:async c=>{try{"error"in await e(c)?d():(i(),r())}catch{d()}},submitOnEnter:!0,formOptions:a,renderInputs:({control:c,formState:C,onKeyDown:u})=>y(F,{spacing:1,alignItems:"start",width:"500px",children:[t(g,{name:"name",control:c,MyTextFieldProps:{label:o.resources.procedureGroup.name(),placeholder:o.resources.procedureGroup.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:u}}),t(g,{name:"description",control:c,MyTextFieldProps:{label:o.resources.procedureGroup.description(),placeholder:o.resources.procedureGroup.description(),fullWidth:!0,onKeyDown:u,multiline:!0,rows:3}}),t(k,{control:c,name:"procedureIDs"})]})})},Ce=()=>{const{isOpen:n,open:r,close:e}=w(!1);return P()("openCreateModal",r),t(T,{open:n,children:t(q,{closeModal:e})})},q=n=>{const{closeModal:r}=n,e=b(),o=h();return t(x,{confirmLabel:e.buttons.create(),handleClose:r,BodyComponent:t(me,{onSuccessCallback:r}),handleConfirm:()=>o.submitCreateForm(),title:e.messages.titles.createResource({resource:e.resources.procedureGroup.title().toLowerCase()})})};q.displayName="ProcedureGroupCreateModal";const Ge=n=>{const{onSuccessCallback:r,record:e,procedureSelected:o}=n,s=b(),a=P(),[i]=pe(),d={mode:"onChange",criteriaMode:"all",resolver:S(p.object({name:p.string().trim().min(1,s.messages.validation.genericRequired({resource:s.resources.procedureGroup.name()})),description:p.string().optional(),procedures:p.array(p.object({id:p.number()})).optional()})),defaultValues:{name:e.name??"",description:e.description??"",procedures:o}},l=R("success",s.messages.titles.editResource({resource:s.resources.procedureGroup.title().toLowerCase()})),c=R("error",s.messages.titles.editResource({resource:s.resources.procedureGroup.title().toLowerCase()}));return t(A,{registerFormFunctions:u=>a("submitEditForm",()=>u.submit&&u.submit()),onSubmit:async u=>{const{procedures:G,...v}=u,z={procedureIDs:G==null?void 0:G.map(f=>f.id),...v};try{"error"in await i({...z,id:e.id})?c():(l(),r())}catch{c()}},submitOnEnter:!0,formOptions:d,renderInputs:({control:u,onKeyDown:G})=>y(F,{spacing:1,alignItems:"start",width:"500px",children:[t(X,{value:e.id,label:"ID",size:"small",disabled:!0,fullWidth:!0}),t(g,{name:"name",control:u,MyTextFieldProps:{label:s.resources.procedureGroup.name(),placeholder:s.resources.procedureGroup.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:G}}),t(g,{name:"description",control:u,MyTextFieldProps:{label:s.resources.procedureGroup.description(),placeholder:s.resources.procedureGroup.description(),fullWidth:!0,onKeyDown:G,multiline:!0,rows:3}}),t(k,{control:u,name:"procedures"})]})})},be=()=>{const{isOpen:n,open:r,close:e}=w(!1),o=J(),s=I(Y(m.PROCEDURE_GROUP)),a=b(),[i]=le(),d=P();d("openEditModal",r);const l=R("success",a.messages.titles.deleteResource({resource:a.resources.procedureGroup.title().toLowerCase()})),c=R("error",a.messages.titles.deleteResource({resource:a.resources.procedureGroup.title().toLowerCase()})),C=M.useCallback(()=>{o({message:`${a.messages.notification.delete({name:`${s==null?void 0:s.name}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in i({id:s==null?void 0:s.id})?c():(l(),e())}}})},[e,i,c,o,l,s==null?void 0:s.id,s==null?void 0:s.name,a.messages.notification]);return d("submitDelete",()=>C()),s?t(T,{open:n,children:t(_,{record:s,closeModal:e},s.id)}):t(U,{})},_=M.forwardRef((n,r)=>{var u;const{closeModal:e,record:o}=n,s=b(),a=h(),{data:i,isFetching:d}=ue({id:o.id}),l=(u=i==null?void 0:i.procedures)==null?void 0:u.map(G=>G.id),{data:c,isFetching:C}=L({filter:{ids:l||void 0}},{skip:!l});return t(x,{ref:r,confirmLabel:s.buttons.update(),handleConfirm:()=>a.submitEditForm(),handleClose:e,isLoading:d||C,BodyComponent:i&&!d&&!C&&t(Ge,{record:i,procedureSelected:c&&c.list.length!==0?c.list:[],onSuccessCallback:e},i.id),title:s.messages.titles.editResource({resource:s.resources.procedureGroup.title().toLowerCase()})})});_.displayName="ProcedureGroupEditModal";const Re=()=>{const n=b(),r=I(Z(E)),{data:e,isFetching:o,refetch:s}=ce(r||W.skipToken),a=h(),{open:i}=K(),d=M.useMemo(()=>[{type:"custom",getColumnDef:l=>l.display({id:"stt",header:n.messages.stt(),cell:c=>t(O,{children:c.row.index+1}),minSize:D,maxSize:D})},{type:"record",name:"id",headerLabel:"ID",renderCell:l=>t(O,{children:l.getValue()}),columnDefOptions:{maxSize:150},enableSort:!0},{type:"record",name:"name",headerLabel:n.resources.procedureGroup.name(),columnDefOptions:{size:650}},{type:"record",name:"description",headerLabel:n.resources.procedureGroup.description(),columnDefOptions:{size:850}}],[n.messages,n.resources.procedureGroup]);return t(ee,{children:t(re,{tableId:E,data:e==null?void 0:e.list,tableColumnsDescription:d,MyDataGridProps:{isLoading:o,onRowRightClick:l=>{i(l)},onRowDoubleClick(){a.openEditModal()}},paginationControls:{totalRecords:e==null?void 0:e.meta.totalRecords,pageSize:e==null?void 0:e.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>t(se,{tableId:E,refetch:s})})})},Pe=()=>{const n=b(),r=h();return y(te,{children:[t(oe,{title:n.resources.procedureGroup.title(),TableComponent:t(Re,{}),ActionButtons:t(U,{children:t(ne,{variant:"contained",onClick:()=>r.openCreateModal(),children:n.buttons.create()})})}),t(Ce,{}),t(be,{}),t(ae,{})]})};export{Pe as AdminProcedureGroup};
