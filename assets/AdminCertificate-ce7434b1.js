import{s as K,j as R,S as V,a as r,aF as T,aG as l,r as F,C as x,ag as k,F as w,bd as Q}from"./vendor-1c7a9a47.js";import{bj as f,cd as $,ex as b,fc as H,ed as M,c8 as g,dn as O,e_ as S,cj as A,ca as C,bc as z,bf as J,b9 as E,bm as j,fd as h,eT as v,f3 as X,f4 as Y,f5 as Z,bv as ee,dM as I,bD as te,cR as re,c2 as se,f6 as D,cb as ie,f7 as ce,f9 as oe,fa as ae,cH as ne,fb as le}from"./index-cdd5c634.js";import{u as ue,a as L,b as de,c as me,d as fe,e as pe}from"./certificate-ac1684c8.js";import{i as B}from"./validateJSON-0b706ffc.js";const W=K("div")`
  .MuiGrid-root > .MuiBox-root {
    padding-left: ${s=>s.theme.spacing(6)};
    padding-right: ${s=>s.theme.spacing(6)};
  }
`,G=s=>{const{record:a,control:i,onKeyDown:t}=s,e=f();return R(V,{spacing:1,alignItems:"start",width:"500px",children:[a&&r($,{value:a.id,size:"small",label:"ID",disabled:!0,fullWidth:!0}),r(b,{name:"account",control:i,MyTextFieldProps:{label:e.resources.certificate.account(),placeholder:e.resources.certificate.account(),fullWidth:!0,required:!0,size:"small",onKeyDown:t}}),r(H,{name:"maskedSecret",control:i,MyTextFieldProps:{label:e.resources.certificate.secret(),placeholder:e.resources.certificate.secret(),fullWidth:!0,size:"small",onKeyDown:t,autoComplete:"new-password"}}),r(b,{name:"name",control:i,MyTextFieldProps:{label:e.resources.certificate.name(),placeholder:e.resources.certificate.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:t}}),r(b,{name:"provider",control:i,MyTextFieldProps:{label:e.resources.certificate.provider(),placeholder:e.resources.certificate.provider(),fullWidth:!0,size:"small",onKeyDown:t}}),r(b,{name:"config",control:i,MyTextFieldProps:{label:e.resources.certificate.config(),placeholder:e.resources.certificate.config(),fullWidth:!0,size:"small",onKeyDown:t,multiline:!0,minRows:3}})]})},ge=s=>{const{onSuccessCallback:a,certificateList:i}=s,t=f(),[e]=ue(),u=M(),o=g("success",t.messages.titles.createResource({resource:t.resources.certificate.title().toLowerCase()})),d=g("error",t.messages.titles.createResource({resource:t.resources.certificate.title().toLowerCase()})),m=async c=>{try{if(c.account&&c.name){const n={account:c.account,name:c.name,provider:c.provider,secret:c.maskedSecret??"",config:c.config};"error"in await e(n)?d():(o(),a())}}catch{d()}},p={mode:"onBlur",criteriaMode:"all",resolver:T(l.object({account:l.string().trim().min(1,t.messages.validation.genericRequired({resource:t.resources.certificate.account()})).refine(c=>!(i&&i.some(n=>n.account===c)),{message:t.messages.validation.genericDuplicated({name:t.resources.certificate.account()})}),name:l.string().trim().min(1,t.messages.validation.genericRequired({resource:t.resources.certificate.name()})),provider:l.string().optional(),maskedSecret:l.string().optional(),config:l.string().refine(c=>c.length?B(c):!0,t.messages.validation.genericRequiredType({resource:t.resources.certificate.config(),type:"jsonObject"})).optional()})),defaultValues:{account:"",name:"",provider:"",maskedSecret:"",config:""}};return r(O,{registerFormFunctions:c=>u("submitCreateForm",()=>c.submit&&c.submit()),onSubmit:m,submitOnEnter:!0,formOptions:p,renderInputs:c=>r(G,{...c})})},be=()=>{const{isOpen:s,open:a,close:i}=z(!1);return M()("openCreateModal",a),r(k,{open:s,children:r(q,{closeModal:i})})},q=F.forwardRef((s,a)=>{const{closeModal:i}=s,t=f(),e=S(),{data:u}=L({filter:{}});return r(W,{children:r(A,{ref:a,confirmLabel:t.buttons.create(),handleClose:i,BodyComponent:u?r(ge,{onSuccessCallback:i,certificateList:u.list}):r(C,{children:r(x,{})}),handleConfirm:()=>e.submitCreateForm(),title:t.messages.titles.createResource({resource:t.resources.certificate.title().toLowerCase()})})})});q.displayName="CertificateCreateModal";const Ce={name:"",account:""},he=()=>{const s=f(),a=J(),[i]=de(),t=E(j(h)),e={mode:"onChange",resolver:T(l.object({name:l.string().trim().optional().transform(v),account:l.string().trim().optional().transform(v)})),defaultValues:{name:(t==null?void 0:t.filter.name)??"",account:(t==null?void 0:t.filter.account)??""}};return r(X,{formOptions:e,onSubmit:o=>{a(ee({tableId:h,filter:o})),i({...t,filter:o})},autoSubmit:!0,submitOnEnter:!0,renderInputs:o=>r(Y,{handleSubmit:o.submit,renderPrimaryField:({open:d,isOpen:m})=>r(Z,{name:"name",control:o.control,handleSubmit:o.submit,handleExpand:d,isExpanded:m,resetFormOnDirty:!1,isFormDirty:o.formState.isDirty,handleReset:()=>o.reset(Ce),MyTextFieldProps:{placeholder:s.resources.certificate.name(),fullWidth:!0,onKeyDown:o.onKeyDown}}),ExtraFieldsComponent:r(b,{name:"account",control:o.control,MyTextFieldProps:{label:s.resources.certificate.account(),placeholder:s.resources.certificate.account(),fullWidth:!0,onKeyDown:o.onKeyDown}})})})},ye=s=>{const{onSuccessCallback:a,record:i,certificateList:t}=s,e=f(),[u]=me(),o=M(),d=g("success",e.messages.titles.editResource({resource:e.resources.certificate.title().toLowerCase()})),m=g("error",e.messages.titles.editResource({resource:e.resources.certificate.title().toLowerCase()})),p=async n=>{const{maskedSecret:y,...N}=n,P={secret:y||"",...N};try{"error"in await u({...P,id:i==null?void 0:i.id})?m():(d(),a())}catch{m()}},c={mode:"onBlur",criteriaMode:"all",resolver:T(l.object({account:l.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.certificate.account()})).refine(n=>n===i.account?!0:!(t&&t.some(y=>y.account===n)),{message:e.messages.validation.genericDuplicated({name:e.resources.certificate.account()})}),name:l.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.certificate.name()})),provider:l.string().optional(),maskedSecret:l.string().optional(),config:l.string().refine(n=>n.length?B(n):!0,e.messages.validation.genericRequiredType({resource:e.resources.certificate.config(),type:"jsonObject"})).optional()})),defaultValues:{account:i.account??"",name:i.name??"",provider:i.provider??"",maskedSecret:i.maskedSecret??"",config:i.config??""}};return r(O,{registerFormFunctions:n=>o("submitEditForm",()=>n.submit&&n.submit()),onSubmit:p,submitOnEnter:!0,formOptions:c,renderInputs:n=>r(G,{record:i,...n})})},Fe=()=>{const s=E(te(re.CERTIFICATE)),{isOpen:a,open:i,close:t}=z(!1),e=f(),[u]=pe(),o=M(),d=I();o("openEditModal",i);const m=g("success",e.messages.titles.deleteResource({resource:e.resources.certificate.title().toLowerCase()})),p=g("error",e.messages.titles.deleteResource({resource:e.resources.certificate.title().toLowerCase()})),c=F.useCallback(()=>{d({message:`${e.messages.notification.delete({name:`${s==null?void 0:s.account}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in u({id:s==null?void 0:s.id})?p():(m(),t())}}})},[t,u,p,d,m,s==null?void 0:s.account,s==null?void 0:s.id,e.messages.notification]);return o("submitDelete",()=>c()),s?r(k,{open:a,children:r(U,{record:s,closeModal:t})}):r(w,{})},U=F.forwardRef((s,a)=>{const{closeModal:i,record:t}=s;I();const e=f(),u=S(),{data:o}=L({filter:{}}),{data:d}=fe({id:t.id});return r(W,{children:r(A,{ref:a,confirmLabel:e.buttons.update(),handleClose:i,BodyComponent:d&&o?r(ye,{record:d,certificateList:o.list,onSuccessCallback:i}):r(C,{children:r(x,{})}),handleConfirm:()=>u.submitEditForm(),deleteLabel:e.buttons.delete(),title:e.messages.titles.editResource({resource:e.resources.certificate.title().toLowerCase()})})})});U.displayName="CertificateEditModal";const Me=s=>{const{FilterComponent:a}=s,i=f(),t=E(j(h)),{data:e,isFetching:u,refetch:o}=L(t||Q.skipToken),d=S(),{open:m}=se(),p=F.useMemo(()=>[{type:"custom",getColumnDef:c=>c.display({id:"stt",header:i.messages.stt(),cell:n=>r(C,{children:n.row.index+1}),minSize:D,maxSize:D})},{type:"record",name:"id",headerLabel:"ID",renderCell:c=>r(C,{children:c.getValue()}),columnDefOptions:{maxSize:50},enableSort:!0},{type:"record",name:"account",headerLabel:i.resources.certificate.account(),columnDefOptions:{size:200}},{type:"record",name:"name",headerLabel:i.resources.certificate.name(),columnDefOptions:{size:300}},{type:"record",name:"provider",headerLabel:i.resources.certificate.provider(),columnDefOptions:{size:300}},{type:"record",name:"config",headerLabel:i.resources.certificate.config(),columnDefOptions:{size:760},renderCell:c=>r(C,{children:c.row.original.config?c.row.original.config:"-"})}],[i.messages,i.resources.certificate]);return R(w,{children:[r(ie,{tableId:h,data:e==null?void 0:e.list,tableColumnsDescription:p,MyDataGridProps:{isLoading:u,onRowRightClick:c=>{m(c)},onRowDoubleClick(){d.openEditModal()}},paginationControls:{totalRecords:e==null?void 0:e.meta.totalRecords,pageSize:e==null?void 0:e.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},FilterComponent:a,renderActionButtons:()=>r(ce,{tableId:h,refetch:o})}),r(Fe,{})]})},Ee=()=>{const s=f(),a=S();return R(oe,{children:[r(ae,{title:s.resources.certificate.title(),TableComponent:r(Me,{FilterComponent:r(he,{})}),ActionButtons:r(w,{children:r(ne,{variant:"contained",onClick:()=>a.openCreateModal(),children:s.buttons.create()})})}),r(be,{}),r(le,{})]})};export{Ee as AdminCertificate};
