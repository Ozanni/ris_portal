import{j as L,S as te,a as o,ao as oe,aF as P,aG as y,r as h,C as $,ag as j,F as T,bd as ne,y as se,I as re,by as ae,s as z,T as ie,bc as le,c9 as _,x as ce}from"./vendor-1c7a9a47.js";import{bj as p,cd as q,ex as B,dm as ue,fA as de,ed as I,c8 as G,dn as U,fB as me,cL as k,e_ as w,cj as H,ca as M,bc as v,dM as Q,fC as pe,b9 as E,bD as V,cR as W,fD as ye,bm as N,fE as F,ey as Ce,c2 as he,f6 as R,cb as K,f7 as J,fF as be,fG as ge,ej as fe,f3 as Te,ei as Ge,bf as Me,fH as Se,f4 as Fe,fI as Le,bv as Ee,fJ as D,eK as Oe,f9 as Re,fa as xe,cH as Ie,fb as we}from"./index-cdd5c634.js";import{d as Ae,a as De}from"./CheckBoxOutlineBlank-b920c4bc.js";import{C as Pe}from"./CollapsiblePanel-1b32f69e.js";const X=e=>{const{record:a,control:n,onKeyDown:s,modalityTypes:t}=e,r=p();return L(te,{spacing:1,alignItems:"start",width:"500px",children:[a&&o(q,{value:a.id,size:"small",label:"ID",disabled:!0,fullWidth:!0}),o(B,{name:"name",control:n,MyTextFieldProps:{label:r.resources.contentGroup.name(),placeholder:r.resources.contentGroup.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:s}}),t&&o(ue,{name:"modalityType",control:n,required:!0,MySelectProps:{label:r.resources.modality.modalityType.short()},children:t.map(l=>o(oe,{value:(l==null?void 0:l.name)||"",children:l.name},l.name))}),o(B,{name:"description",control:n,MyTextFieldProps:{label:r.resources.contentGroup.description(),placeholder:r.resources.contentGroup.description(),fullWidth:!0,onKeyDown:s,multiline:!0,rows:2}})]})},x=3,ze=e=>{const{onSuccessCallback:a,record:n,modalityTypes:s}=e,t=p(),[r]=de(),l=I(),d=G("success",t.messages.titles.editResource({resource:t.resources.contentGroup.title().toLowerCase()})),u=G("error",t.messages.titles.editResource({resource:t.resources.contentGroup.title().toLowerCase()})),m=async i=>{try{if(i.name){const b={name:i.name,description:i.description??"",modalityType:i.modalityType??"",id:n.id};"error"in await r({...b})?u():(d(),a())}}catch{u()}},c={mode:"onBlur",criteriaMode:"all",resolver:P(y.object({name:y.string().trim().min(x,t.messages.validation.genericMinLength({resource:t.resources.contentGroup.name(),length:x})),modalityType:y.string({required_error:t.messages.validation.genericRequired({resource:t.resources.contentGroup.modalityType()})}),description:y.string()})),defaultValues:{name:n.name??"",modalityType:n.modalityType??void 0,description:n.description??""}};return o(U,{registerFormFunctions:i=>l("submitEditForm",()=>i.submit&&i.submit()),onSubmit:m,submitOnEnter:!0,formOptions:c,renderInputs:i=>o(X,{modalityTypes:s,record:n,...i})})},ke=e=>{const{onSuccessCallback:a,modalityTypes:n}=e,s=p(),[t]=me(),r=I(),l=G("success",s.messages.titles.createResource({resource:s.resources.contentGroup.title().toLowerCase()})),d=G("error",s.messages.titles.createResource({resource:s.resources.contentGroup.title().toLowerCase()})),u=async c=>{try{if(c.name){const i={name:c.name,modalityType:c.modalityType??"",description:c.description??""};"error"in await t(i)?d():(l(),a())}}catch{d()}},m={mode:"onBlur",criteriaMode:"all",resolver:P(y.object({name:y.string().trim().min(x,s.messages.validation.genericMinLength({resource:s.resources.contentGroup.name(),length:x})),modalityType:y.string({required_error:s.messages.validation.genericRequired({resource:s.resources.contentGroup.modalityType()})}),description:y.string().optional()})),defaultValues:{name:"",description:""}};return o(U,{registerFormFunctions:c=>r("submitCreateForm",()=>c.submit&&c.submit()),onSubmit:u,submitOnEnter:!0,formOptions:m,renderInputs:c=>o(X,{...c,modalityTypes:n})})},ve=()=>{const{isOpen:e,open:a,close:n}=v(!1);return I()("openCreateModal",a),o(j,{open:e,children:o(Y,{closeModal:n})})},Y=h.forwardRef((e,a)=>{const{closeModal:n}=e,s=p(),{data:t}=k({filter:{}}),r=w();return o(H,{ref:a,confirmLabel:s.buttons.create(),handleClose:n,BodyComponent:t?o(ke,{onSuccessCallback:n,modalityTypes:t.list}):o(M,{children:o($,{})}),handleConfirm:()=>r.submitCreateForm(),title:s.messages.titles.createResource({resource:s.resources.contentGroup.title().toLowerCase()})})});Y.displayName="ContentGroupCreateModal";const Ne=()=>{const e=E(V(W.CONTENT_GROUP)),{isOpen:a,open:n,close:s}=v(!1),t=p(),[r]=ye(),l=Q(),d=I();d("openEditModal",n);const u=G("success",t.messages.titles.deleteResource({resource:t.resources.contentGroup.title().toLowerCase()})),m=G("error",t.messages.titles.deleteResource({resource:t.resources.contentGroup.title().toLowerCase()})),c=h.useCallback(()=>{l({message:`${t.messages.notification.delete({name:`${e==null?void 0:e.name}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in r({id:e==null?void 0:e.id})?m():(u(),s())}}})},[s,r,m,l,u,e==null?void 0:e.id,e==null?void 0:e.name,t.messages.notification]);return d("submitDelete",()=>c()),e?o(j,{open:a,children:o(Z,{record:e,closeModal:s})}):o(T,{})},Z=h.forwardRef((e,a)=>{const{closeModal:n,record:s}=e;Q();const t=p(),r=w(),{data:l}=k({filter:{}}),{data:d}=pe({id:s.id});return o(H,{ref:a,confirmLabel:t.buttons.update(),handleClose:n,BodyComponent:d&&l?o(ze,{record:d,modalityTypes:l.list,onSuccessCallback:n}):o(M,{children:o($,{})}),handleConfirm:()=>r.submitEditForm(),deleteLabel:t.buttons.delete(),handleDelete:()=>{r.submitDelete(),n()},title:t.messages.titles.editResource({resource:t.resources.contentGroup.title().toLowerCase()})})});Z.displayName="ContentGroupEditModal";const _e=e=>{const{FilterComponent:a}=e,n=p(),s=E(N(F)),{data:t,isFetching:r,refetch:l}=Ce(s||ne.skipToken),d=w(),{open:u}=he(),m=h.useMemo(()=>[{type:"custom",getColumnDef:c=>c.display({id:"stt",header:n.messages.stt(),cell:i=>o(M,{children:i.row.index+1}),minSize:R,maxSize:R})},{type:"record",name:"id",headerLabel:"ID",renderCell:c=>o(M,{children:c.getValue()}),columnDefOptions:{maxSize:150},enableSort:!0},{type:"record",name:"name",headerLabel:n.resources.contentGroup.name(),columnDefOptions:{size:550}},{type:"record",name:"modalityType",headerLabel:n.resources.contentGroup.modalityType(),columnDefOptions:{size:250}},{type:"record",name:"description",headerLabel:n.resources.contentGroup.description(),columnDefOptions:{size:750}}],[n.messages,n.resources.contentGroup]);return o(K,{tableId:F,data:t==null?void 0:t.list,FilterComponent:a,tableColumnsDescription:m,MyDataGridProps:{isLoading:r,onRowRightClick:c=>{u(c)},onRowDoubleClick(){d.openEditModal()}},paginationControls:{totalRecords:t==null?void 0:t.meta.totalRecords,pageSize:t==null?void 0:t.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>o(J,{tableId:F,refetch:l})})},Be=e=>{const{handleSubmit:a,MyAutoCompleteProps:n}=e,s=p();return o(se,{name:e.name,control:e.control,render:({field:t})=>o(be,{children:o(ge,{...t,onChange:(r,l)=>{t.onChange(l)},id:e.id,size:e.size??"small",multiple:!0,disableCloseOnSelect:!0,limitTags:e.limitTags??5,renderInput:r=>o(q,{...r,size:"small",label:e.label,placeholder:e.placeholder,InputProps:{...r.InputProps,startAdornment:L(T,{children:[o(fe,{title:s.buttons.search(),children:o(re,{sx:{padding:0},onClick:a,children:o(ae,{})})}),r.InputProps.startAdornment]})}}),...n})})})},$e=()=>{var c;const e=p(),a=Me(),{data:n}=k({filter:{}}),[s]=Se(),t=E(N(F)),r=o(Ae,{fontSize:"small"}),l=o(De,{fontSize:"small"}),d=(c=n==null?void 0:n.list)==null?void 0:c.map(i=>i.name),u={mode:"onChange",resolver:P(y.object({modalityTypes:y.array(y.string()).transform(i=>i&&i.length?i:void 0).optional()})),defaultValues:{modalityTypes:(t==null?void 0:t.filter.modalityTypes)??void 0}};return o(je,{formOptions:u,onSubmit:i=>{a(Ee({tableId:F,filter:i})),s({...t,filter:i})},submitOnEnter:!0,autoSubmit:!0,renderInputs:({control:i,submit:b})=>o(Fe,{handleSubmit:b,renderPrimaryField:()=>o(Be,{control:i,name:"modalityTypes",placeholder:e.resources.modality.modalityType.long(),handleSubmit:b,MyAutoCompleteProps:{options:d??[],fullWidth:!0,ListboxProps:{style:{maxHeight:300}},disablePortal:!0,isOptionEqualToValue:(C,g)=>C===g,getOptionLabel:C=>`${C}`,renderTags:(C,g)=>{const O=C.length,f=2,ee=C.slice(0,f);return L(T,{children:[ee.map((A,S)=>h.createElement(_,{...g({index:S}),size:"small",key:S,label:A??""})),O>f&&o(Le,{MyMenuProps:{transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"}},ActionComponent:o(qe,{variant:"body2",children:`+${O-f}`}),ListMenu:o(Ue,{children:C.slice(f).map((A,S)=>h.createElement(_,{...g({index:S+f}),size:"small",key:`${S+f}`,label:A??""}))})})]})},renderOption:(C,g,{selected:O})=>L("li",{...C,children:[o(ce,{icon:r,checkedIcon:l,style:{marginRight:8},checked:O}),g]})}}),ExtraFieldsComponent:o(T,{})})})},je=z(Te)`
  .MuiAutocomplete-root .MuiOutlinedInput-root.MuiInputBase-sizeSmall {
    padding: ${e=>e.theme.spacing(.5,1)};
    max-height: ${e=>e.theme.spacing(4.5)};
  }
`,qe=z(ie)`
  padding: 0 ${e=>e.theme.spacing(.5)};
  border-radius: 5px;
  margin-left: ${e=>e.theme.spacing(1)};
  background-color: ${e=>le(e.theme.palette.primary.main,.1)};
  :hover {
    ${Ge.onMenuHover};
  }
`,Ue=z("div")`
  display: flex;
  gap: ${e=>e.theme.spacing(.5)};
  max-width: 300px;
  overflow: auto;
`,He=e=>{const{contentGroupID:a}=e,n=p(),s=E(N(D)),{data:t,isFetching:r,refetch:l}=Oe({...s,filter:{groupID:a}}),d=h.useMemo(()=>[{type:"custom",getColumnDef:u=>u.display({id:"stt",header:n.messages.stt(),cell:m=>o(M,{children:m.row.index+1}),minSize:R,maxSize:R})},{type:"record",name:"id",headerLabel:"ID",renderCell:u=>o(M,{children:u.getValue()}),columnDefOptions:{maxSize:50}},{type:"record",name:"name",headerLabel:n.resources.content.name.short()},{type:"custom",getColumnDef:u=>u.display({id:"user",header:()=>n.resources.content.user(),cell:m=>{var c;return(c=m.row.original.user)==null?void 0:c.fullname}})},{type:"record",name:"description",headerLabel:n.resources.content.impression()}],[n.messages,n.resources.content]);return o(K,{tableId:D,data:t==null?void 0:t.list,tableColumnsDescription:d,paginationControls:{totalRecords:t==null?void 0:t.meta.totalRecords,pageSize:t==null?void 0:t.list.length},MyDataGridProps:{isLoading:r},TanstackTableOptions:{enableRowSelection:!1},renderActionButtons:()=>o(J,{tableId:D,refetch:l,hideButtonAdd:!0,hideButtonDelete:!0,hideButtonEdit:!0})})},Qe=()=>{const e=E(V(W.CONTENT_GROUP)),{isOpen:a,open:n,close:s}=v(!0),t=e==null?void 0:e.id,r=e==null?void 0:e.name,l=p();return t?o(Pe,{initialExpanded:a,onExpand:n,onCollapse:s,onClose:s,title:l.messages.titles.contentList({resource:r||""}),children:o(He,{contentGroupID:t})},t):o(T,{})},Xe=()=>{const e=p(),a=w();return L(Re,{children:[o(xe,{title:e.resources.contentGroup.title(),TableComponent:o(_e,{FilterComponent:o($e,{})}),PanelComponent:o(Qe,{}),ActionButtons:o(T,{children:o(Ie,{variant:"contained",onClick:()=>a.openCreateModal(),children:e.buttons.create()})})}),o(ve,{}),o(Ne,{}),o(we,{})]})};export{Xe as AdminContentGroup};
