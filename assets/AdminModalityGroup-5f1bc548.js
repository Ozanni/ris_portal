import{aF as A,aG as d,a as o,j as S,S as I,r as M,ag as P,C as V,F as T,bd as Y}from"./vendor-1c7a9a47.js";import{bj as y,ed as C,c8 as h,dn as w,ex as g,e_ as x,cj as k,bc as L,eZ as Q,cd as H,dM as z,ca as f,b9 as R,bD as v,cR as B,bm as $,fx as F,c2 as X,f6 as D,be as Z,cb as U,f7 as W,bo as J,fy as E,f9 as K,fa as ee,cH as te,fb as oe}from"./index-cdd5c634.js";import{b as se,a as O,c as re,d as ie,e as ae}from"./modalityGroup-498fdde8.js";import{c as ne}from"./checkUpdateFields-04f48d15.js";import{C as le}from"./CollapsiblePanel-1b32f69e.js";const de=r=>{const{onSuccessCallback:a}=r,[t]=se(),{data:s}=O({filter:{}}),n=s==null?void 0:s.list,e=y(),l=C(),c={mode:"onChange",criteriaMode:"all",resolver:A(d.object({name:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.modalityGroup.code()})),code:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.modalityGroup.code()})).refine(u=>!(n&&n.some(i=>i.code===u)),{message:e.messages.validation.genericDuplicated({name:e.resources.modalityGroup.code()})}),description:d.string().optional(),index:d.union([d.string(),d.number()]).optional()})),defaultValues:{name:"",code:"",description:"",index:void 0}},m=h("success",e.messages.titles.createResource({resource:e.resources.modalityGroup.title().toLowerCase()})),p=h("error",e.messages.titles.createResource({resource:e.resources.modalityGroup.title().toLowerCase()}));return o(w,{registerFormFunctions:u=>l("submitCreateForm",()=>u.submit&&u.submit()),onSubmit:async u=>{try{"error"in await t(u)?p():(m(),a())}catch{p()}},submitOnEnter:!0,formOptions:c,renderInputs:({control:u,onKeyDown:i})=>S(I,{spacing:1,alignItems:"start",width:"500px",children:[o(g,{name:"name",control:u,MyTextFieldProps:{label:e.resources.modalityGroup.name(),placeholder:e.resources.modalityGroup.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:i}}),o(g,{name:"code",control:u,MyTextFieldProps:{label:e.resources.modalityGroup.code(),placeholder:e.resources.modalityGroup.code(),fullWidth:!0,required:!0,size:"small",onKeyDown:i}}),o(g,{name:"index",control:u,MyTextFieldProps:{label:e.resources.modalityGroup.index(),placeholder:e.resources.modalityGroup.index(),fullWidth:!0,size:"small",type:"number",onKeyDown:i}}),o(g,{name:"description",control:u,MyTextFieldProps:{label:e.resources.modalityGroup.description(),placeholder:e.resources.modalityGroup.description(),fullWidth:!0,onKeyDown:i,multiline:!0,rows:2}})]})})},ce=()=>{const{isOpen:r,open:a,close:t}=L(!1);return C()("openCreateModal",a),o(P,{open:r,children:o(_,{closeModal:t})})},_=M.forwardRef(r=>{const{closeModal:a}=r,t=y(),s=x();return o(k,{confirmLabel:t.buttons.create(),handleClose:a,BodyComponent:o(de,{onSuccessCallback:a}),handleConfirm:()=>s.submitCreateForm(),title:t.messages.titles.createResource({resource:t.resources.modalityGroup.title().toLowerCase()})})});_.displayName="ModalGroupCreateModal";const ue=r=>{const{onSuccessCallback:a,record:t}=r,[s]=re(),{data:n}=O({filter:{}}),e=y(),l=C(),c=n==null?void 0:n.list.filter(i=>i.id!==t.id),m={mode:"onChange",criteriaMode:"all",resolver:A(d.object({name:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.modalityGroup.code()})),code:d.string().trim().min(1,e.messages.validation.genericRequired({resource:e.resources.modalityGroup.code()})).refine(i=>!(c&&c.some(b=>b.code===i)),{message:e.messages.validation.genericDuplicated({name:e.resources.modalityGroup.code()})}),description:d.string().optional().transform(Q),index:d.union([d.string(),d.number()])})),defaultValues:{name:t.name??"",index:t.index??void 0,code:t.code??"",description:t.description??""}},p=h("success",e.messages.titles.editResource({resource:e.resources.modalityGroup.title().toLowerCase()})),G=h("error",e.messages.titles.editResource({resource:e.resources.modalityGroup.title().toLowerCase()}));return o(w,{registerFormFunctions:i=>l("submitEditForm",()=>i.submit&&i.submit()),onSubmit:async i=>{const{updateData:b,canUpdate:j}=ne(Object.keys(i),t,i);if(j)try{"error"in await s({...b,id:t.id})?G():(p(),a())}catch{G()}},submitOnEnter:!0,formOptions:m,renderInputs:({control:i,onKeyDown:b})=>S(I,{spacing:1,alignItems:"start",width:"500px",children:[o(H,{value:t.id,size:"small",label:"ID",disabled:!0,fullWidth:!0}),o(g,{name:"name",control:i,MyTextFieldProps:{label:e.resources.modalityGroup.name(),placeholder:e.resources.modalityGroup.name(),fullWidth:!0,required:!0,size:"small",onKeyDown:b}}),o(g,{name:"code",control:i,MyTextFieldProps:{label:e.resources.modalityGroup.code(),placeholder:e.resources.modalityGroup.code(),fullWidth:!0,required:!0,size:"small",onKeyDown:b}}),o(g,{name:"index",control:i,MyTextFieldProps:{label:e.resources.modalityGroup.index(),placeholder:e.resources.modalityGroup.index(),fullWidth:!0,size:"small",type:"number",onKeyDown:b}}),o(g,{name:"description",control:i,MyTextFieldProps:{label:e.resources.modalityGroup.description(),placeholder:e.resources.modalityGroup.description(),fullWidth:!0,onKeyDown:b,multiline:!0,rows:2}})]})})},me=()=>{const{isOpen:r,open:a,close:t}=L(!1),s=R(v(B.MODALITY_GROUP)),n=C();n("openEditModal",a);const e=z(),l=y(),[c]=ae(),m=h("success",l.messages.titles.deleteResource({resource:l.resources.modalityGroup.title().toLowerCase()})),p=h("error",l.messages.titles.deleteResource({resource:l.resources.modalityGroup.title().toLowerCase()})),G=M.useCallback(()=>{e({message:`${l.messages.notification.delete({name:`${s==null?void 0:s.code}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in c({id:s==null?void 0:s.id})?p():(m(),t())}}})},[t,c,p,e,m,s==null?void 0:s.code,s==null?void 0:s.id,l.messages.notification]);return n("submitDelete",()=>G()),s?o(P,{open:r,children:o(q,{record:s,closeModal:t})}):o(T,{})},q=M.forwardRef((r,a)=>{const{closeModal:t,record:s}=r,n=y();z();const e=x(),{data:l}=ie({id:s.id});return o(k,{ref:a,confirmLabel:n.buttons.update(),handleConfirm:()=>e.submitEditForm(),handleClose:t,BodyComponent:l?o(ue,{record:l,onSuccessCallback:t}):o(f,{children:o(V,{})}),title:n.messages.titles.editResource({resource:n.resources.modalityGroup.title().toLowerCase()})})});q.displayName="ModalityGroupEditModal";const pe=()=>{const r=y(),a=R($(F)),{data:t,isFetching:s,refetch:n}=O(a||Y.skipToken),e=x(),{open:l}=X(),c=M.useMemo(()=>[{type:"custom",getColumnDef:m=>m.display({id:"stt",header:r.messages.stt(),cell:p=>o(f,{children:p.row.index+1}),minSize:D,maxSize:D})},{type:"record",name:"id",headerLabel:"ID",renderCell:m=>o(f,{children:m.getValue()}),columnDefOptions:{maxSize:50},enableSort:!0},{type:"record",name:"name",headerLabel:r.resources.modalityGroup.name(),columnDefOptions:{size:400}},{type:"record",name:"code",headerLabel:r.resources.modalityGroup.code(),columnDefOptions:{size:160}},{type:"record",name:"index",headerLabel:r.resources.modalityGroup.index(),columnDefOptions:{size:160}},{type:"record",name:"description",headerLabel:r.resources.modalityGroup.description(),columnDefOptions:{size:850}}],[r.messages,r.resources.modalityGroup]);return o(Z,{children:o(U,{tableId:F,data:t==null?void 0:t.list,tableColumnsDescription:c,MyDataGridProps:{isLoading:s,onRowRightClick:m=>{l(m)},onRowDoubleClick(){e.openEditModal()}},paginationControls:{totalRecords:t==null?void 0:t.meta.totalRecords,pageSize:t==null?void 0:t.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>o(W,{tableId:F,refetch:n})})})},ye=r=>{const{modalityGroupID:a}=r,t=y(),{data:s,isFetching:n,refetch:e}=J({filter:{groupID:a}}),l=M.useMemo(()=>[{type:"record",name:"id",headerLabel:"ID",renderCell:c=>o(f,{children:c.getValue()}),columnDefOptions:{maxSize:50}},{type:"record",name:"name",headerLabel:t.resources.modality.name.short()},{type:"record",name:"modalityType",headerLabel:t.resources.modality.modalityType.short()},{type:"record",name:"code",headerLabel:t.resources.modality.code.short()},{type:"record",name:"enabled",headerLabel:t.messages.status.long(),renderCell:c=>o(f,{children:c.getValue()?t.resources.modality.enabled():t.resources.modality.disabled()})}],[t.messages,t.resources.modality]);return o(U,{tableId:E,data:s==null?void 0:s.list,tableColumnsDescription:l,paginationControls:{totalRecords:s==null?void 0:s.meta.totalRecords,pageSize:s==null?void 0:s.list.length},MyDataGridProps:{isLoading:n},TanstackTableOptions:{enableRowSelection:!1},renderActionButtons:()=>o(W,{tableId:E,refetch:e,hideButtonAdd:!0,hideButtonDelete:!0,hideButtonEdit:!0})})},be=()=>{const r=R(v(B.MODALITY_GROUP)),a=r==null?void 0:r.id,t=r==null?void 0:r.code,{isOpen:s,open:n,close:e}=L(!0),l=y();return a?o(le,{initialExpanded:s,onExpand:n,onCollapse:e,onClose:e,title:l.messages.titles.modalityList({resource:t||""}),children:o(ye,{modalityGroupID:a})},a):o(T,{})},Ce=()=>{const r=y(),a=x();return S(K,{children:[o(ee,{title:r.resources.modalityGroup.title(),TableComponent:o(pe,{}),PanelComponent:o(be,{}),ActionButtons:o(T,{children:o(te,{variant:"contained",onClick:()=>a.openCreateModal(),children:r.buttons.create()})})}),o(ce,{}),o(me,{}),o(oe,{})]})};export{Ce as AdminModalityGroup};
