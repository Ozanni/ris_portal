import{a as s,ao as D,j as y,F as S,S as z,Z as x,T as _,aF as E,aG as b,r as F,ag as w,C as U,bd as j}from"./vendor-1c7a9a47.js";import{cP as Q,cR as m,eN as $,cQ as W,cS as H,bj as g,e5 as K,dm as L,ex as P,cd as X,ew as Z,e2 as J,ed as R,g8 as Y,c8 as p,dn as O,e_ as M,cj as G,ca as h,bc as V,g9 as ee,ga as te,b9 as N,bD as se,gb as re,dM as oe,bm as ie,gc as A,c2 as ne,gd as ae,f6 as T,cb as le,f7 as ce,f9 as ue,fa as de,fb as fe}from"./index-cdd5c634.js";const ge=Q.injectEndpoints({endpoints:e=>({getOneConfigAttribute:e.query({query:({id:t})=>({url:`${m.CONFIG_ATTRIBUTE}/${t}`,method:"GET",useAsync:!0,useHospitalID:!0}),providesTags:(t,r)=>r?[]:[{type:m.CONFIG_ATTRIBUTE,id:t==null?void 0:t.id}],transformResponse:$}),getListConfigAttribute:e.query({query:t=>W(t,m.CONFIG_ATTRIBUTE),providesTags:(t={list:[],meta:{totalRecords:0}})=>t.list?[{type:m.CONFIG_ATTRIBUTE,id:"LIST"},...t.list.map(r=>({type:m.CONFIG_ATTRIBUTE,id:r.id}))]:[],transformResponse:H})})}),{useGetListConfigAttributeQuery:be,useLazyGetListConfigAttributeQuery:me,useGetOneConfigAttributeQuery:Te,useLazyGetOneConfigAttributeQuery:Ee}=ge,pe=({control:e,watch:t,disabled:r=!1,required:n=!1})=>{const i=g(),c=t("attributeID"),[u]=me(),f=async()=>{var a;return((a=(await u({filter:{}})).data)==null?void 0:a.list)??[]};return s(K,{name:"attributeID",control:e,required:n,MySelectProps:{label:i.resources.config.attribute(),disabled:r},disableValue:c,onGetListRecord:f,renderSelectField:({listData:a,formSelectFieldProps:l})=>s(L,{...l,children:a.map(o=>s(D,{value:(o==null?void 0:o.id)||"",children:o.id},o.id))})})};var B=(e=>(e.BOOLEAN="BOOLEAN",e.STRING="STRING",e))(B||{});const Ce=({control:e,name:t,MyTextFieldProps:r})=>y(L,{name:t,control:e,MySelectProps:{label:r==null?void 0:r.label,disabled:r==null?void 0:r.disabled},children:[s(D,{value:"True",children:"True"},"True"),s(D,{value:"False",children:"False"},"False")]}),ye=({control:e,MyTextFieldProps:t,watch:r,name:n})=>{var l;const i=r("attributeID"),{data:c}=be({filter:{}}),f=((l=((c==null?void 0:c.list)??[]).find(o=>o.id===i))==null?void 0:l.datatype)??`${B.STRING}`;return s(S,{children:(o=>{switch(o){case"BOOLEAN":return s(Ce,{name:n,control:e,MyTextFieldProps:t});default:return s(P,{name:n,control:e,MyTextFieldProps:t})}})(f)})},v=e=>{const t=g(),{control:r,record:n,onKeyDown:i,watch:c}=e;return y(z,{width:"400px",spacing:1,children:[n&&s(X,{value:n.id,label:"ID",size:"small",disabled:!0,fullWidth:!0}),s(pe,{control:r,watch:c,required:!n,disabled:!!n}),s(ye,{control:r,name:"attributeValue",watch:c,MyTextFieldProps:{label:t.resources.config.attributeValue(),placeholder:t.resources.config.attributeValue(),fullWidth:!0,required:!n,size:"small",onKeyDown:i}}),s(Z,{control:r,render:({value:u,onChange:f})=>y(x,{sx:{display:"flex",alignItems:"center"},children:[s(J,{checked:!!u,onChange:f}),s(_,{children:t.resources.config.preferred()})]}),name:"preferred"})]})},he=({onSuccessCallback:e})=>{const t=g(),r=R(),[n]=Y(),i={mode:"onBlur",criteriaMode:"all",resolver:E(b.object({attributeID:b.string().trim().min(1,t.messages.validation.genericRequired({resource:t.resources.config.attribute()})),attributeValue:b.string().trim().min(1,t.messages.validation.genericRequired({resource:t.resources.config.attributeValue()})),preferred:b.boolean().optional()})),defaultValues:{attributeID:"",attributeValue:"",preferred:void 0}},c=p("success",t.messages.titles.createResource({resource:t.resources.config.title().toLowerCase()})),u=p("error",t.messages.titles.createResource({resource:t.resources.config.title().toLowerCase()}));return s(O,{registerFormFunctions:a=>r("submitCreateForm",()=>a.submit&&a.submit()),onSubmit:async a=>{const{attributeID:l,attributeValue:o,preferred:d}=a;try{"error"in await n({attributeID:l??"",attributeValue:o??"",preferred:d??!1})?u():(c(),e&&e())}catch{u()}},submitOnEnter:!0,formOptions:i,renderInputs:a=>s(v,{...a})})},Fe=()=>{const{isOpen:e,open:t,close:r}=V(!1);return R()("openCreateModal",t),s(w,{disableEnforceFocus:!0,open:e,children:s(k,{closeModal:r})})},k=F.forwardRef((e,t)=>{const{closeModal:r}=e,n=g(),i=M();return s(G,{ref:t,confirmLabel:n.buttons.create(),handleClose:r,BodyComponent:s(h,{children:s(he,{onSuccessCallback:r})}),handleConfirm:()=>i.submitCreateForm(),title:n.messages.titles.createResource({resource:n.resources.config.title().toLowerCase()})})});k.displayName="ConfigCreateModal";const Re=({onSuccessCallback:e,record:t})=>{var l;const r=g(),n=R(),[i]=ee(),c={mode:"onBlur",criteriaMode:"all",resolver:E(b.object({attributeID:b.string(),attributeValue:b.string().optional(),preferred:b.boolean().optional()})),defaultValues:{attributeID:((l=t.attribute)==null?void 0:l.id)??"",attributeValue:t.attributeValue??"",preferred:t.preferred??!1}},u=p("success",r.messages.titles.editResource({resource:r.resources.config.title().toLowerCase()})),f=p("error",r.messages.titles.editResource({resource:r.resources.config.title().toLowerCase()}));return s(O,{registerFormFunctions:o=>n("submitEditForm",()=>o.submit&&o.submit()),onSubmit:async o=>{const{attributeValue:d,preferred:C}=o;try{const I={id:t.id,attributeValue:d??"",preferred:C};"error"in await i(I)?f():(u(),e&&e())}catch{f()}},submitOnEnter:!0,formOptions:c,renderInputs:o=>s(v,{record:t,...o})})},Ie=()=>{const e=N(se(m.CONFIG)),{isOpen:t,open:r,close:n}=V(!1),i=g(),[c]=re(),u=R(),f=oe();u("openEditModal",r);const a=p("success",i.messages.titles.deleteResource({resource:i.resources.config.title().toLowerCase()})),l=p("error",i.messages.titles.deleteResource({resource:i.resources.config.title().toLowerCase()})),o=F.useCallback(()=>{var d;e&&f({message:`${i.messages.notification.delete({name:`${(d=e==null?void 0:e.attribute)==null?void 0:d.id}`})}`,options:{variant:"warning",onConfirm:()=>{"error"in c({id:e.id})?l():(a(),n())}}})},[n,c,l,f,a,e,i.messages.notification]);return u("submitDelete",()=>o()),e?s(w,{disableEnforceFocus:!0,open:t,children:s(q,{record:e,closeModal:n})}):s(S,{})},q=F.forwardRef((e,t)=>{const{closeModal:r,record:n}=e,{data:i}=te({id:(n==null?void 0:n.id)??0},{skip:!n}),c=g(),u=M();return s(G,{ref:t,confirmLabel:c.buttons.update(),handleClose:r,BodyComponent:s(h,{children:i?s(Re,{onSuccessCallback:r,record:i}):s(U,{})}),handleConfirm:()=>u.submitEditForm(),deleteLabel:c.buttons.delete(),handleDelete:()=>{u.submitDelete(),r()},title:c.messages.titles.editResource({resource:c.resources.config.title().toLowerCase()})})});q.displayName="ConfigEditModal";const Ae=()=>{const e=g(),t=N(ie(A)),{open:r}=ne(),n=M(),{data:i,isFetching:c,refetch:u}=ae(t||j.skipToken),f=F.useMemo(()=>[{type:"custom",getColumnDef:a=>a.display({id:"stt",header:e.messages.stt(),cell:l=>s(h,{children:l.row.index+1}),minSize:T,maxSize:T})},{type:"custom",getColumnDef:a=>a.display({id:"attribute",header:()=>e.resources.config.attributeID(),cell:l=>{var o,d;return(d=(o=l.row.original)==null?void 0:o.attribute)==null?void 0:d.id},size:250})},{type:"custom",getColumnDef:a=>a.display({id:"attribute",header:()=>e.resources.config.attributeName(),cell:l=>{var o,d;return(d=(o=l.row.original)==null?void 0:o.attribute)==null?void 0:d.name},size:250})},{type:"custom",getColumnDef:a=>a.display({id:"attribute",header:()=>e.resources.config.attributeDatatype(),cell:l=>{var o,d;return(d=(o=l.row.original)==null?void 0:o.attribute)==null?void 0:d.datatype},size:250})},{type:"custom",getColumnDef:a=>a.display({id:"attributeValue",header:()=>e.resources.config.attributeValue(),cell:l=>{var o;return(o=l.row.original)==null?void 0:o.attributeValue},size:250})},{type:"custom",getColumnDef:a=>a.display({id:"preferred",header:()=>e.resources.config.preferred(),cell:l=>{var o;return s(h,{children:(o=l.row.original)!=null&&o.preferred?e.resources.config.preferred():e.messages.no()})},size:150})}],[e.messages,e.resources.config]);return s(le,{tableId:A,data:i==null?void 0:i.list,tableColumnsDescription:f,MyDataGridProps:{isLoading:c,onRowRightClick:a=>{r(a)},onRowDoubleClick(){n.openEditModal()}},paginationControls:{totalRecords:i==null?void 0:i.meta.totalRecords,pageSize:i==null?void 0:i.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},renderActionButtons:()=>s(ce,{tableId:A,refetch:u})})},we=()=>{const e=g();return y(ue,{children:[s(de,{title:e.resources.config.title(),ActionButtons:s(S,{}),TableComponent:s(Ae,{})}),s(Fe,{}),s(Ie,{}),s(fe,{})]})};export{we as AdminConfig};
