import{s as S,aF as N,aG as u,a as r,S as L,j as p,T as z,r as w,ag as j,ao as b,bd as U,F as Q}from"./vendor-1c7a9a47.js";import{cP as k,cR as c,eN as R,cQ as _,cS as V,b9 as T,bD as F,bj as h,dM as q,c8 as C,dn as H,ex as g,gf as M,e2 as X,cj as Y,dl as J,bc as Z,ed as K,ce as ee,cf as te,gg as se,bf as re,bm as x,gh as y,eT as E,f3 as oe,f4 as ne,f5 as ae,dm as O,e5 as ie,gi as le,bv as de,eh as ce,e_ as P,ca as D,f6 as A,cw as G,cx as I,cb as ue,f7 as me,f9 as pe,fa as ge}from"./index-cdd5c634.js";const he=k.injectEndpoints({endpoints:e=>({getOneEventLog:e.query({query:({id:s})=>({url:`${c.EVENT_LOG}/${s}`,method:"GET",useAsync:!0,useHospitalID:!0}),providesTags:(s,t)=>t?[]:[{type:c.EVENT_LOG,id:s==null?void 0:s.id}],transformResponse:R}),getListEventLog:e.query({query:s=>_(s,"eventLog"),providesTags:(s={list:[],meta:{totalRecords:0}})=>[{type:c.EVENT_LOG,id:"LIST"},...s.list.map(t=>({type:c.EVENT_LOG,id:t.id}))],transformResponse:V}),resendEvent:e.mutation({query(s){return{url:`${c.EVENT_LOG}/${s.id}/resend`,method:"GET",useAsync:!0,useHospitalID:!0}},invalidatesTags:(s,t,i)=>t?[]:[{type:c.EVENT_LOG,id:i.id}],transformResponse:R})})}),{useGetListEventLogQuery:ve,useLazyGetListEventLogQuery:Le,useGetOneEventLogQuery:fe,useResendEventMutation:be}=he,B=e=>{const s=T(F(c.EVENT_LOG)),t=h(),i=q(),n=C("success",t.messages.titles.editResource({resource:t.resources.eventLog.title().toLowerCase()})),l=C("error",t.messages.titles.editResource({resource:t.resources.eventLog.title().toLowerCase()})),[v]=be(),a=()=>{i({message:t.messages.notification.resendRequest({type:(s==null?void 0:s.type)??"",key:(s==null?void 0:s.key)??""}),options:{variant:"warning",onConfirm:()=>{o()}}})},o=async()=>{s&&("error"in await v({id:s.id})?l():(n(),e&&e()))};return{handleClickButton:a}},ye=e=>{const{record:s}=e,t=h(),i={mode:"onChange",criteriaMode:"all",resolver:N(u.object({})),defaultValues:{attempts:s.attempts??void 0,createdTime:s.createdTime??void 0,type:s.type??void 0,succeeded:s.succeeded??void 0,source:s.source??void 0,id:s.id??void 0,availableAt:s.availableAt??void 0,key:s.key??void 0,errors:s.errors??void 0,payload:s.payload??void 0}};return r(H,{onSubmit:async l=>{},submitOnEnter:!0,formOptions:i,renderInputs:({control:l,formState:v,onKeyDown:a,watch:o})=>r(L,{alignItems:"start",width:"800px",children:p(Ee,{children:[p(L,{spacing:1,width:"100%",children:[r(g,{name:"id",control:l,MyTextFieldProps:{label:t.resources.eventLog.id(),placeholder:t.resources.eventLog.id(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(g,{name:"type",control:l,MyTextFieldProps:{label:t.resources.eventLog.type(),placeholder:t.resources.eventLog.type(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(g,{name:"source",control:l,MyTextFieldProps:{label:t.resources.eventLog.source(),placeholder:t.resources.eventLog.source(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(M,{name:"createdTime",watch:o,control:l,disabled:!0,type:"dateTime",TextFieldProps:{label:t.resources.eventLog.createdTime(),placeholder:t.resources.eventLog.createdTime(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(M,{name:"availableAt",watch:o,control:l,disabled:!0,type:"dateTime",TextFieldProps:{label:t.resources.eventLog.availableAt(),placeholder:t.resources.eventLog.availableAt(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(g,{name:"attempts",control:l,MyTextFieldProps:{label:t.resources.eventLog.attempts(),placeholder:t.resources.eventLog.attempts(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(L,{flexDirection:"row",children:p(L,{display:"flex",flexDirection:"row",alignItems:"center",children:[r(X,{checked:!!s.succeeded,disabled:!0}),r(z,{children:t.messages.notification.success()})]})})]}),p(L,{spacing:3,width:"100%",children:[r(g,{name:"key",control:l,MyTextFieldProps:{label:t.resources.eventLog.key(),placeholder:t.resources.eventLog.key(),fullWidth:!0,onKeyDown:a,disabled:!0}}),r(g,{name:"errors",control:l,MyTextFieldProps:{label:t.resources.eventLog.errors(),placeholder:t.resources.eventLog.errors(),fullWidth:!0,onKeyDown:a,disabled:!0,multiline:!0,rows:3}}),r(Te,{children:r(g,{name:"payload",control:l,MyTextFieldProps:{label:t.resources.eventLog.payload(),placeholder:t.resources.eventLog.payload(),fullWidth:!0,onKeyDown:a,disabled:!0,multiline:!0,rows:4}})})]})]})})})},Te=S("div")`
  .MuiFormControl-root .MuiInputBase-root {
    padding: ${e=>e.theme.spacing(1)} 0;
    background-color: ${e=>{var s;return(s=e.theme.pacs)==null?void 0:s.customColors.fieldDisabledBackground}};
  }
`,Ee=S("div")`
  display: grid;
  width: 100%;
  grid-template-columns: 1fr 1fr;
  gap: ${e=>e.theme.spacing(2)};
`,Se=()=>{const{isOpen:e,open:s,close:t}=Z(!1),i=T(F(c.EVENT_LOG)),{data:n}=fe({id:(i==null?void 0:i.id)??0},{skip:!(i!=null&&i.id)});return K()("openEditModal",s),r(j,{open:e,children:r(W,{closeModal:t,record:n})})},W=w.forwardRef((e,s)=>{const{closeModal:t,record:i}=e,n=h(),{handleClickButton:l}=B(t);return r(Y,{ref:s,confirmLabel:n.resources.eventLog.resend(),handleClose:t,BodyComponent:i?r(ye,{record:i}):r(J,{}),handleConfirm:()=>l(),title:n.resources.eventLog.logInfomation()})});W.displayName="EventLogInfoModal";const Fe=()=>{const{handleClickButton:e}=B(),s=T(F(c.EVENT_LOG)),t=h();return r(ee,{title:t.resources.eventLog.resend(),disabled:!s,onClick:()=>e(),children:r(te,{IconComponent:se,IconComponentProps:{color:"inherit"}})})},Re=k.injectEndpoints({endpoints:e=>({getListEventLogSource:e.query({query:s=>_(s,c.EVENT_LOG_SOURCE),providesTags:(s={list:[],meta:{totalRecords:0}})=>[{type:c.EVENT_LOG_SOURCE},...s.list.map(t=>({type:c.EVENT_LOG_SOURCE,id:t.id}))],transformResponse:V})})}),{useGetListEventLogSourceQuery:we,useLazyGetListEventLogSourceQuery:Ce}=Re;var $=(e=>(e.HIS_INTEGRATE="HIS_INTEGRATE",e.WORKLIST_INTEGRATE="WORKLIST_INTEGRATE",e))($||{});const Me={source:void 0,succeeded:void 0,fromDate:"",toDate:""},Oe=e=>typeof e!="boolean"?-1:e?1:2,De=()=>{const e=h(),s=re(),[t]=Le(),[i]=Ce(),n=T(x(y)),l=async()=>{var o;return((o=(await i({filter:{}},!0)).data)==null?void 0:o.list)??[]},v={mode:"onChange",resolver:N(u.object({source:u.union([u.string(),u.nativeEnum($)]).transform(E).optional(),succeeded:u.boolean().optional(),succeededNumber:u.number().optional(),fromDate:u.string().trim().optional().transform(E),toDate:u.string().trim().optional().transform(E)}).transform(o=>{const d=o.succeededNumber;let m;switch(d){case-1:m=void 0;break;case 1:m=!1;break;case 2:m=!0;break}return{...o,succeededNumber:void 0,succeeded:m}})),defaultValues:{fromDate:(n==null?void 0:n.filter.fromDate)??"",toDate:(n==null?void 0:n.filter.toDate)??"",source:(n==null?void 0:n.filter.source)??void 0,succeededNumber:Oe(n==null?void 0:n.filter.succeeded)}};return r(oe,{formOptions:v,onSubmit:o=>{s(de({tableId:y,filter:o})),t({...n,filter:o})},autoSubmit:!0,submitOnEnter:!0,renderInputs:o=>r(ne,{handleSubmit:o.submit,renderPrimaryField:({open:d,isOpen:m})=>r(ae,{name:"fakeField",control:o.control,handleSubmit:()=>{},handleExpand:d,isExpanded:m,isFormDirty:o.formState.isDirty,handleReset:()=>o.reset(Me),MyTextFieldProps:{placeholder:e.buttons.search(),fullWidth:!0,onChange:()=>{},value:""}}),ExtraFieldsComponent:p(L,{spacing:1,children:[p(O,{name:"succeededNumber",control:o.control,MySelectProps:{label:e.resources.eventLog.succeeded()},children:[r(b,{value:-1,children:" "},"null"),r(b,{value:2,children:e.messages.notification.success()},2),r(b,{value:1,children:e.messages.notification.failure()},1)]}),r(ie,{name:"source",control:o.control,disableValue:(n==null?void 0:n.filter.source)??"",MySelectProps:{label:e.resources.eventLog.source()},onGetListRecord:l,renderSelectField:({listData:d,formSelectFieldProps:m})=>p(O,{...m,children:[r(b,{value:"",children:" "},"null"),d.map(f=>r(b,{value:(f==null?void 0:f.name)||"",children:f.name},f.id))]})}),r(le,{nameStart:"fromDate",nameEnd:"toDate",label:e.resources.eventLog.createdTime(),formSetValue:o.setValue,watch:o.watch})]})})})},Ae=S("div",ce)`
  color: ${e=>{var s,t;if(!e.$succeeded){if(e.$attempts===3)return(s=e.theme.pacs)==null?void 0:s.customColors.text.red;if(!e.$succeeded&&e.$attempts<3)return(t=e.theme.pacs)==null?void 0:t.customColors.text.blue}}};
`,Ge=()=>{const e=h(),s=T(x(y)),{data:t,isFetching:i,refetch:n}=ve(s||U.skipToken),l=P(),v=w.useMemo(()=>{const a=({eventLog:o,children:d})=>r(Ae,{$succeeded:o.succeeded??!1,$attempts:o.attempts??0,children:d});return[{type:"custom",getColumnDef:o=>o.display({id:"stt",header:e.messages.stt(),cell:d=>r(D,{children:r(a,{eventLog:d.row.original,children:d.row.index+1})}),maxSize:A,minSize:A})},{type:"record",name:"id",headerLabel:"ID",renderCell:o=>r(D,{children:r(a,{eventLog:o.row.original,children:o.getValue()})}),columnDefOptions:{maxSize:150},enableSort:!0},{type:"record",name:"type",renderCell:o=>r(a,{eventLog:o.row.original,children:o.getValue()}),headerLabel:e.resources.eventLog.type(),columnDefOptions:{size:250}},{type:"record",name:"source",renderCell:o=>r(a,{eventLog:o.row.original,children:o.getValue()}),headerLabel:e.resources.eventLog.source(),columnDefOptions:{size:250}},{type:"record",name:"createdTime",renderCell:o=>{var d;return r(a,{eventLog:o.row.original,children:o.row.original.createdTime&&((d=G(o.row.original.createdTime))==null?void 0:d.format(I.dateTime))})},headerLabel:e.resources.eventLog.createdTime(),columnDefOptions:{size:250}},{type:"record",name:"lastAttempt",renderCell:o=>{var d;return r(a,{eventLog:o.row.original,children:o.row.original.lastAttempt&&((d=G(o.row.original.lastAttempt))==null?void 0:d.format(I.dateTime))})},headerLabel:e.resources.eventLog.lastAttempt(),columnDefOptions:{size:250}},{type:"record",name:"attempts",renderCell:o=>r(a,{eventLog:o.row.original,children:o.getValue()}),headerLabel:e.resources.eventLog.attempts(),columnDefOptions:{size:250}},{type:"record",name:"succeeded",renderCell:o=>r(a,{eventLog:o.row.original,children:o.getValue()?e.messages.notification.success():e.messages.notification.failure()}),headerLabel:e.resources.eventLog.succeeded(),columnDefOptions:{size:250}}]},[e.messages,e.resources.eventLog]);return r(ue,{tableId:y,data:t==null?void 0:t.list,tableColumnsDescription:v,MyDataGridProps:{isLoading:i,onRowDoubleClick:()=>l.openEditModal()},paginationControls:{totalRecords:t==null?void 0:t.meta.totalRecords,pageSize:t==null?void 0:t.list.length},TanstackTableOptions:{enableRowSelection:!0,enableMultiRowSelection:!1},FilterComponent:r(De,{}),renderActionButtons:()=>r(me,{tableId:y,CustomButton:r(Fe,{}),hideButtonAdd:!0,hideButtonDelete:!0,hideButtonEdit:!0,refetch:n})})},ke=()=>{const e=h();return P(),p(pe,{children:[r(ge,{title:e.resources.eventLog.title(),ActionButtons:r(Q,{}),TableComponent:r(Ge,{})}),r(Se,{})]})};export{ke as AdminEventLog};
